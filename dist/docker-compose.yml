version: "3.1"
services:
  imageboard:
    container_name: imageboard
    image: gibsn/imageboard
    volumes:
        - static:/usr/local/imageboard/static
        - media:/usr/local/imageboard/media
  nginx:
    container_name: nginx
    image: gibsn/nginx
    volumes:
        - static:/static
        - media:/media
    secrets:
        - server.key
        - server.crt
    depends_on:
        - imageboard
    ports:
        - "80:80"
        - "443:443"

volumes:
    static:
    media:

secrets:
    server.key:
        file: ../certs/server.key
    server.crt:
        file: ../certs/server.crt
